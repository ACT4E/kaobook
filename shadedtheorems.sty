\ProvidesPackage{shadedtheorems}

% Shaded theorems

% Modified from Jim Hefferon's Linear Algebra book.
% https://gitlab.com/jim.hefferon/linear-algebra/blob/master/bookjhconcrete.sty

\usepackage{amsmath} % Improved mathematics
\usepackage{amsfonts} % Mathematical fonts
\usepackage{amssymb} % AMS symbols and environments
\usepackage{amsthm} % Mathematical environments
\usepackage{thmtools}
%\usepackage{unicode-math}           % Use unicode math font, not TeX
%\usepackage{mathtools}              % More math symbols and environments
%\setmathfont{Asana-Math.otf}
\usepackage{framed}
%\usepackage{mdframed}

\definecolor{bgcolor}{HTML}{FCFFDC}
\colorlet{shadecolor}{bgcolor} 
\definecolor{shaderulecolor}{rgb}{0.1529,0.2510,0.5451} % RoyalBlue

\declaretheoremstyle[
  % spaceabove=.5\thm@preskip, spacebelow=.5\thm@postskip,
  headfont=\normalfont\bfseries,
  notefont=\normalfont\bfseries, notebraces={ (}{)},
  headformat={\NUMBER\ \NAME\NOTE\ignorespaces}, % note that \thetheorem is redefined below so \NUMBER is altered
  headpunct={},
  bodyfont=\normalfont,
  postheadspace={.618em plus .2em minus .1em},
  preheadhook={\begin{snugshade}},
  postfoothook={\end{snugshade}}
%   % for doing this with mdframed, see also http://tex.stackexchange.com/questions/34405/shaded-theorems-thmtools-spanning-pages
]{shadedtext}  % for text that has a shaded box behind it TODO: make the frames not add any vertical space, add a rule to the frame

\declaretheoremstyle[
  % spaceabove=.5\thm@preskip, spacebelow=.5\thm@postskip,
  headfont=\normalfont\bfseries,
  notefont=\normalfont\bfseries, notebraces={ (}{)},
  headformat={\NUMBER\ \NAME\NOTE\ignorespaces}, % note that \thetheorem is redefined below so \NUMBER is altered
  headpunct={},
  bodyfont=\normalfont,
  postheadspace={.618em plus .2em minus .1em},
]{text}   % for text that is not shaded 

\declaretheoremstyle[
  % spaceabove=.5\thm@preskip, spacebelow=.5\thm@postskip,
  headfont=\normalfont\small\scshape,
  notefont=\normalfont\small\scshape, notebraces={ (}{)},
  headformat={\NAME\NOTE\ignorespaces}, % note that \thetheorem is redefined below so \NUMBER is altered
  headpunct={},
  bodyfont=\normalfont,
  postheadspace={.618em plus .2em minus .1em},
  prefoothook={\hfill\qedsymbol}
]{pf}  % for proofs, with qedsymbol at the end

\declaretheorem[name=Theorem,
                style=shadedtext,
                numberwithin=subsection,]{theorem}
   % \surroundwithmdframed[style=thmstyle]{theorem}\resetparens[theorem]

\declaretheorem[name=Proposition,
                style=shadedtext,
				sibling=theorem]{proposition}
   % \surroundwithmdframed[style=thmstyle]{theorem}\resetparens[theorem]

\declaretheorem[name=Definition,
                style=shadedtext,
                sibling=theorem]{definition} 
   % \surroundwithmdframed[style=thmstyle]{definition} \resetparens[definition]

\declaretheorem[name=Lemma,
                style=shadedtext,
                sibling=theorem]{lemma}
   % \surroundwithmdframed[style=thmstyle]{lemma}\resetparens[lemma]

\declaretheorem[name=Corollary,
                style=shadedtext,
                sibling=theorem]{corollary}
   % \surroundwithmdframed[style=thmstyle]{corollary}\resetparens[corollary]

\declaretheorem[name=Example,
                style=text,
                sibling=theorem]{example}

\declaretheorem[name=Exercise,
                style=text,
                sibling=theorem]{exercise}

\declaretheorem[name=Remark,
                style=text,
                sibling=theorem]{remark}

\let\proof\@undefined                        % undefine \proof
\let\endproof\@undefined                  % undefine \endproof
\declaretheorem[name=Proof,
                style=pf,
                numberwithin=subsection]{proof}

% Theorem number style
\renewcommand{\thetheorem}{\arabic{subsection}.\arabic{theorem}}
% styling of proofs
\renewcommand{\proofname}{{\scshape\small Proof}}
% End of \begin{proof} ... \end{proof}
\renewcommand{\qedsymbol}{{\scshape\small QED}}
